<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Task Pulse Smart V8.2</title>

<link rel="preload" as="image" href="taskpulse-splash-hex.jpeg" />
<link rel="manifest" href="manifest.json" />
<link rel="icon" href="icon-192.png" sizes="192x192" />
<meta name="theme-color" content="#0f111a" />

<style>
  :root{
    /* Core palette from V6 + V7 accents */
    --bg:#050611;
    --card:#141725;
    --ink:#e9ecf5;
    --muted:#a7b0cf;
    --line:#262a3c;
    --pill:#1b2440;
    --pad:14px;
    --radius:16px;
    --tap:50px;
    --fs:16px;
    --warn:#ffcc66;
    --good:#76e0a6;
    --bad:#ff8ea1;
    --accent:#27b7ff;
    --accent-soft:#193b66;
  }
  @media (max-width:480px){
    :root{ --pad:12px; --radius:14px; --tap:56px; --fs:17px }
  }
  *{
    box-sizing:border-box;
    -webkit-tap-highlight-color:transparent;
    margin:0;
    padding:0;
  }

  html,body{height:100%}

  body{
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--ink);
    font-size:var(--fs);
    background:radial-gradient(circle at top,#1d2440 0,#050611 55%);
    display:flex;
    align-items:flex-start;
    justify-content:center;
    padding:12px;
  }

  /* Outer shell from V7 */
  .shell{
    max-width:900px;
    width:100%;
    background:#050814;
    border-radius:18px;
    box-shadow:0 18px 60px rgba(0,0,0,.7);
    padding:16px 18px 14px;
    border:1px solid #20263c;
  }

  .wrap{
    max-width:820px;
    margin:0 auto;
    padding:4px var(--pad) calc(40px + env(safe-area-inset-bottom));
  }

  /* Header / brand */
  .hero-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:10px;
  }
  .brand{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .logo-pill{
    width:42px;
    height:42px;
    border-radius:999px;
    background:radial-gradient(circle at 30% 20%,#5fffd0 0,#0fd0ff 40%,#0b1428 80%);
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow:0 0 18px rgba(0,255,213,.5);
    font-weight:800;
    letter-spacing:.03em;
    color:white;
  }
  .brand-title{
    font-size:18px;
    font-weight:700;
  }
  .brand-sub{
    font-size:11px;
    color:var(--muted);
  }
  .top-right{
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    gap:4px;
    font-size:11px;
    color:var(--muted);
  }
  .badge{
    padding:2px 8px;
    border-radius:999px;
    border:1px solid #3b425d;
    font-size:11px;
    background:var(--pill);
  }
  .badge.good{border-color:#3bd47a;color:#7fffb3;}
  .badge.warn{border-color:#e7a74c;color:#ffd78a;}

  /* KPI pill row */
  .kpi-pill{
    margin:6px 0 10px;
    padding:7px 10px;
    border-radius:999px;
    border:1px solid var(--line);
    color:var(--muted);
    font-size:13px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:rgba(10,15,30,.9);
  }

  /* Tabs */
  .tabs{
    position:sticky;
    top:0;
    z-index:50;
    padding:4px 0 4px;
    background:linear-gradient(180deg, rgba(5,8,20,.98) 0%, rgba(5,8,20,.88) 70%, rgba(5,8,20,0) 100%);
    backdrop-filter:saturate(130%) blur(4px);
    margin-bottom:6px;
  }
  .tabbar{
    display:flex;
    gap:6px;
    overflow:auto;
    padding-bottom:4px;
  }
  .tabbar button{
    flex:1;
    min-width:110px;
    padding:7px 10px;
    font-size:13px;
    border-radius:999px;
    border:1px solid transparent;
    background:var(--pill);
    color:var(--muted);
    cursor:pointer;
    font-weight:500;
    white-space:nowrap;
  }
  .tabbar button.active{
    background:linear-gradient(135deg,#27b7ff,#4df2ff);
    color:#04101b;
    font-weight:600;
    box-shadow:0 0 18px rgba(39,183,255,.6);
  }

  .tabpage{display:none}
  .tabpage.active{display:block}

  /* Cards & layout */
  .card{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:var(--radius);
    padding:10px 10px 8px;
    margin:8px 0;
    box-shadow:0 6px 30px rgba(0,0,0,.25);
  }
  .row{
    display:flex;
    gap:6px;
    align-items:center;
    flex-wrap:wrap;
  }
  input,select,button{
    border-radius:999px;
    border:1px solid var(--line);
    background:#050814;
    color:var(--ink);
    padding:7px 11px;
    min-height:var(--tap);
    font-size:13px;
  }
  input[type=text]{flex:1 1 200px; min-width:0;}
  button.primary{
    background:linear-gradient(135deg,#27b7ff,#4df2ff);
    color:#04101b;
    border:none;
    font-weight:600;
    cursor:pointer;
    white-space:nowrap;
  }
  button{
    cursor:pointer;
  }
  .btn-ghost{
    background:transparent;
    border:1px solid var(--line);
    color:var(--muted);
  }
  .btn-danger{
    background:rgba(224,82,100,.12);
    border:1px solid #e05264;
    color:#ff9da8;
  }

  .muted{color:var(--muted);}
  .list{list-style:none;margin:0;padding:0}

  /* Task rows */
  .task{
    display:grid;
    grid-template-columns:auto 1fr auto auto;
    gap:8px;
    align-items:center;
    padding:7px 8px;
    margin-bottom:4px;
    border-radius:10px;
    background:#101528;
    border:1px solid #1e2234;
  }
  .task input[type="checkbox"]{width:15px;height:15px;}
  .task div:first-of-type{
    min-height:40px;
    display:flex;
    flex-direction:column;
    justify-content:center;
  }
  .priority{
    display:inline-block;
    border-radius:999px;
    padding:1px 6px;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.04em;
    margin-top:4px;
  }
  .p-low{background:#16352b;color:#7af3b1;}
  .p-med{background:#3a321b;color:#ffe08a;}
  .p-high{background:#3d1b25;color:#ff9ab2;}

  .stars button{
    border:none;
    background:transparent;
    cursor:pointer;
    font-size:14px;
    opacity:.4;
  }
  .stars button.on{
    opacity:1;
    text-shadow:0 0 8px rgba(255,215,120,.7);
  }
  .actions{display:flex;gap:4px;}
  .actions button{
    border:none;
    background:transparent;
    cursor:pointer;
    font-size:15px;
    padding:0 2px;
    color:#99a4d2;
  }
  .actions .del{color:#ff9ba9;}
  .task .meta{margin-top:4px;font-size:12px;color:#9fb0d0;opacity:.9}

  .sum{
    display:flex;
    justify-content:space-between;
    padding:7px 10px;
    background:#0e1324;
    border:1px solid var(--line);
    border-radius:12px;
    font-size:12px;
    margin-top:6px;
  }
  .nav{display:flex;gap:4px;justify-content:flex-end}

  /* History list */
  .hist-row{
    border-radius:12px;
    border:1px solid var(--line);
    padding:10px 12px;
    margin:6px 0;
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:#101528;
  }
  .hist-row .meta{color:#9fb0d0;font-size:12px;margin-top:4px}
  .hist-row button{
    border-radius:999px;
    padding:6px 10px;
  }

  /* Banners */
  #carryWarn{
    display:none;
    margin:6px 0 0 0;
    padding:6px 9px;
    border-radius:9px;
    background:#221525;
    border:1px solid #b26ad5;
    font-size:11px;
    color:#f0d5ff;
  }
  #medsReminder{
    display:none;
    margin:8px 0 0 0;
    padding:10px 12px;
    border-radius:12px;
    border:1px solid #3e4a13;
    background:#161d07;
    color:#d8ee8a;
    font-weight:600;
  }
  #medsReminder small{
    display:block;
    color:#b9c66a;
    font-weight:400;
    margin-top:4px;
  }
  #medsReminder button{
    margin-left:6px;
    border-radius:9px;
    border:1px solid #ff9d3b;
    background:#2a1b0d;
    color:#ffd8a2;
    padding:6px 14px;
    font-size:0.86rem;
    box-shadow:0 0 10px rgba(255,140,40,0.35);
  }

  /* Meds card styling */
  .meds-card{
    padding:10px 10px 10px;
  }
  .meds-head{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:6px;
  }
  .meds-head-title{
    font-size:14px;
    font-weight:600;
  }
  .meds-head-tag{
    font-size:11px;
    padding:2px 8px;
    border-radius:999px;
    background:#101828;
    color:#9fd2ff;
    border:1px solid #294064;
  }
  .meds-row{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-bottom:6px;
  }
  .meds-btn{
    flex:1 1 150px;
    min-width:0;
    border-radius:14px;
    padding:10px 12px;
    background:#050814;
    border:1px solid #27324b;
    text-align:left;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .meds-btn-title{
    font-size:13px;
    font-weight:600;
  }
  .meds-btn-sub{
    font-size:11px;
    color:#a7b0cf;
  }
  .meds-btn-taken{
    background:radial-gradient(circle at 20% 0%,#29f3aa 0,#1d8c64 40%,#061b18 80%);
    border-color:#39f5b8;
    box-shadow:0 0
